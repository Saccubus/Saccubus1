【ニコニコ】コメント付動画作成ツール さきゅばすスレ(前スレ)
<http://hibari.2ch.net/test/read.cgi/software/1235626069/>
の３４１氏の 1.22r3 を元に、NicoBrowser拡張1.4.4
（作者：雪羽氏）の一部機能を借用して改造しました。
また、ニコニコランキングメーカーnicorankから機能を借用しました。

　・1.22r3e6 (2011/8/11)　IEのセッション共有修正、Opera追加


修正・改変点
　1.22r3e6
　・セッション共有で８月のWindowsUpdateのIEのクッキー仕様変更に対応
　　対応ブラウザOpera追加、ログインチェック改善

　1.22r3e5以降
　・ブラウザからセッション情報を取得し共有、ブラウザがログアウトしない
　　IE7/8/9, Firefox5, Chrome13対応（nicorankから機能借用）
　・nicovideoE.dllをリリース（nicovideoとnicovideo16x9の統合版）
　・auto.batで引数が足りない時にstacktraceでなくエラーメッセージを出す

　1.22r3e4以降
　・ワイド画面(16;9)対応Vhookライブラリnicovideo16x9.dllを
　　従来のnicovideo.dllと半自動で切り替えられるように変更

　1.22r3e3以降
　・DLファル名にffmpegが認識できない文字があった時エラーとなるのを修正
　・内部記述修正色々、機能は変更なし

　1.22r3e2以降
　・ファイル選択ダイアログの結果のファイル名を絶対パス名から
　　相対パス名に変更
　・過去ログ指定時に文字列が解析できない場合と一般会員の場合は
　　エラー終了に変更。但し動画の保存は先に行えるようにする。
　・コメント付き動画の保存ファイル名を
　　　指定フォルダ\タイトル\オプションファイル名＋FFmpeg設定.拡張子
　　とする設定を追加（デバッグ用）
　・黒幕あり（-padtop,-padbottom）を新しいffmpeg(rev.23043以降)で
　　-vfilters pad=に変更したときに、vhookライブラリと両立出来るように修正
　・｢不適切な内容が含まれている｣動画をダウンロードする場合に
　　http://www.nicovideo.jp/watch/sm1234556789?watch_harmful=1
　　と指定すればダウンロード出来るように修正

　1.22r3e1a以降
　・NicoBrowser拡張1.4.4用のffmpegに対する不具合を修正
　・過去ログを結合中のデバッグ用メッセージの量を減らす
　・過去ログの結合方式を変更し不要な項目も残すように変更
　　（若干、結果ファイルサイズが増えた）

　1.22r3e以降
　・過去ログのダウンロードのURL修正（1.4.4と同等レベル）
　　（過去ログのダウンロードはプレミアム会員のみ）
　・公式動画のコメントをダウンロード可能（1.4.4と同等レベル）
　・投稿者コメントをダウンロード・付加可能（1.4.4と同等レベル）
　・自動で調整する取得コメント数を最新のニコニコ動画仕様に変更
　　1分間100コメ、10分以上は1000コメまで
　・動画タイトルの最後に付く空白を削除
　・コメントファイル名に[日時]を追加可能
　　複数のコメントファイルを動画に付加可能に。
　　（プレミアム会員で過去ログを使えば1000コメ以上付加可能）
　・投稿者コメントのスクリプト(ニワン語)を無視する
　　→投稿者のスクリプトが無駄に動画に付加されない。


おまけ
　1.22r3e4
　・選択した拡張Vhookの種類と動画サイズ・アスペクト比を表示
　　（自動判定時のみ）

　1.22r3e3以降
　・前回正常終了した時の動画idを記憶する（１つだけ）

　1.22r3e1a以降
　・ダウンロードした動画の設定FFmpegによるデコード結果の表示の際
　　フォルダ指定の場合は直前にダウンロードしていなくても捜して
　　デコードするように変更した。
　・ダウンロード・変換時の経過時間を表示
　・ダウンロード・変換時間と最終フレームの情報をデバッグログに出力

　1.22r3e以降
　・設定されたFFmpegのバージョンを表示
　・ダウンロードした動画の設定FFmpegによるデコード結果を表示
　　（動画サイズ、ビットレート、fps、動画codec、音声codecなど）


修正・改変点、おまけは、さきゅばす上で青文字で表示しています。


サポート解説など
　さきゅばすの使い方などに関しては、
　公式サイト　http://saccubus.sourceforge.jp/
　同梱のさきゅばす1.22rのreadme.txt、1.22r3のreadme+.txtを
　ご覧下さい。
　1.22r3e以降の不具合報告等はさきゅばすスレでお願いします。
　http://hibari.2ch.net/test/read.cgi/software/1310301611/


動作環境
　Windows XP/7　32bit（多分Vistaも動くはず）
　　　　　　　（64bitは環境が無い為テストしていません）。
　javaランタイム（JRE1.6 または JDK6）が必要です。
　　　　　　　　（JRE1.5 JDK5はテストしていません。）

注意
　・本Revの人柱用レベルは1.22r3e4と同じくらいです。
　・64bitWinは元々動作確認していませんが今回は特に非対応です。
　　万一動いたらお知らせ下さるとありがたいです。

インストール方法
　既にさきゅばすを使用中の方
　・Saccubus.jarを差し替えます。
　・1.22r3e5のbinフォルダ内のファイルを使用中のbinフォルダに
　　コピーして下さい。
　　(もしファイルが上書きされる場合、先にバックアップして下さい)
　・拡張Vhookライブラリ指定は2つある指定欄両方に nicovideoE.dll を
　　指定し、2個のチェックボックス両方にチェックするとDL動画の
　　アスペクト比を自動判定します。

　初めてさきゅばすを使う方
　・前スレ>>341
　　(http://www.ne.jp/asahi/mochiyama/my/file/Saccubus-1.22r3.zip)
　　をダウンロードし展開します。
　　binフォルダの FFmpeg.exe, ○○○.dll などと
　　optionフォルダ　が必要です。
　　*** 同梱しているbinフォルダのファイルだけでは動作しません ***
　・1.22r3e5を1.22r3を展開したフォルダにコピーします。
　　念の為に、元のSaccubus.jarはリネーム後保存しておいて下さい。
　　Saccubus.jarを差し替えてください。


起動
　　Saccubus.exe または Saccubus.jarをダブルクリックします。
　　メールアドレス、パスワードを入力します。
　　動画idを入力します。URLの後ろに?hogehogeがついてもOKです。
　　（不適切な内容が含まれている場合は、?watch_harmful=1 をつけます）
　　過去ログをダウンロードするには日付を
　　2009/7/7 7:7:7 や 2009/7/7 7:7 や 2009/7/7 のように入力します。
　　右上の変換ボタンをクリックするとダウンロードと変換が開始します。

●ブラウザのセッション共有機能について
　・セッションを共有したいブラウザの所にチェックします。
　・ブラウザでログインしていれば、さきゅばす側でメールアドレス、
　　パスワードを入力しなくてもニコニコ動画からDL出来ます。
　・さきゅばすが後からログインしてもブラウザはログアウトされません。
　・ブラウザを終了してもPCを電源OFFしてもログインされたままです。
　　（セッションの期限切れまで）
　・ブラウザがログアウトした場合は、さきゅばすもログイン出来ません。
　　その場合は、ブラウザでもう一度ログインするか、
　　さきゅばす側で単体でログインして下さい。
　　但し、さきゅばす単体でログインした場合は残念ながら、ブラウザが
　　ログアウトされます。
　　（ブラウザがさきゅばすのセッション情報を利用できないため）

　■本機能はニコニコランキングメーカーnicorankから頂きました。感謝。
　　ニコニコランキングメーカー配布サイト↓
　　http://www.daily-vocaran.info/nicorank/
　　ソースファイル↓
　　http://sourceforge.jp/projects/nicorank/downloads/40282/nicorank186_src.zip/
　　（最新版ソースは SVN　http://svn.sourceforge.jp/svnroot/nicorank/）


●拡張Vhook統合版 (nicovideoE.dll)について
　・nicovideo.dllのソースから、投稿者コメント付加機能と、
　　nicovideo16x9のワイド対応修正を統合しました。(多少の差有)
　・拡張Vhook統合版の指定方法は下の拡張Vhookワイドと同じですが
　　２つの指定場所の両方に同じnicovideoE.dllを指定します。
　※1.22r3e4a以前のさきゅばす本体との使用も可能ですが、
　　自動判定は出来ません。従来モード固定となります。

●拡張Vhookワイド（nicovideo16x9.dll）について
　（1.22r3e5には入っていません。1.22r3e4に入っていました。）
　・従来のnicovideo.dllより、16:9動画での字の大きさはニコニコ公式に
　　近いですが完全な再現は未達成です。(統合版を更に修正検討中)
　・拡張Vhookの指定方法は次の通りです。
　　２個選択時→DL動画を検査してアスペクト比を判定しVhookを選択
　　１個選択時→指定されたVhookを使用して変換、無検査
　　０個選択時→エラー
　■　コメント付き動画(変換後)のアスペクト比を変更したり　■
　■　判定したりはしないので注意してください。　　　　　　■

●過去ログを複数ファイルに保存する
　・「保存設定」「動画・コメント」画面の
　　<保存するフォルダを指定し、ファイル名は自動で決定する>と
　　<コメントファイル名に時刻を付加する>チェックボックスを
　　チェックします。<取得コメント数>は1000に設定します。
　　1000以上にしても１回にダウンロード出来るのは1000までです。
　　最初は「保存設定」「コメント付き動画」画面の
　　<動画を変換する>にチェックをしません。

　・まず過去ログを日付を変えて複数回ダウンロードします。
　　<動画をダウンロードする>のは1回だけで十分です。

　・過去ログが集まったら、<動画を変換する>をチェックし、
　　変換ボタンをクリックすると、同一IDの全コメントを結合して
　　コメント付き動画に変換します。

　・同時表示コメント数を増やすには「変換設定」画面の
　　<表示コメント数>を、既定値の４０より大きくします。

　・動画をダウンロードした直後に「動画設定」画面の一番下の
　　<DL動画>ボタンをクリックして動画をチェックしておくと
　　FFmpegの設定ミスが減らせるかも？

●動作が変なときは
　・debug.batをダブルクリックして起動します。
　　本体が起動するので後は同じです。終了後
　　ログがフォルダ直下の log.txt に出力されるので
　　参考にして下さい。
　・デバッグのためコメント作業ファイルを消しておらず
　　そのまま残しています。コメントを調べたい方はどうぞ。
　　フォルダ直下の
　　　vhook.tmp　　　　一般コメント中間ファイル(Unicode-LE)
　　　vhookowner.tmp　投稿者コメント中間ファイル(Unicode-LE)
　　　tmp_comment.xml　過去ログ結合結果ファイル(UTF-8N)
　　動画に比べ小容量なので消さないのをご了解ください。

●auto.batで動作が変な時、記録を取りたい時は
　・auto.batの記述を確かめます。
　・autodebug.batをダブルクリックして起動します。
　　auto.batが実行されるので終了するまで待ちます。
　　途中でエラーが起きても、最後の動画まで実行してから終了します。
　　autolog.txtにログが記録されます。


■機能確認
　・ブラウザのセッション共有機能確認は
　　Win7 Home 32bit + IE9, Firefox5.0, Chrome13 及び
　　XP SP3 Home 32bit + IE8, Firefox5.0, Chrome13 で行いました。
　・動画変換確認は、1.22r3（SVN-21400 前スレ341）、及び、NicoBrowser
　　拡張1.4.4用 ffmpeg 2011/5/21版 (git-N-30117) で行いました。
　　Win7 32bit Core2Duo, WinXP 32bit CeleronD
　・但し再生確認はPC上だけで、携帯その他では未確認
　・前スレ>>670 は変換エラーする動画(Decoder not found)がありました。
　・前スレ>>481(SVN-23386)は livx264でのマルチスレッドオプション
　　（-threads）が機能しないかもしれません。
　・NicoBrowser拡張1.4.4さきゅばす用に配布している
　　libavも動くかもしれません。


収録物
・まず最初に.txt
・LICENSE.txt　　　　　　　 GPLライセンス
・gpl.ja.txt 　　　　　　　 GPLライセンスの非公式日本語訳
・LGPL_LICENSE　　　　　　　GPLライセンス
・Saccubus.jar　　　　　　　本体　1.22r3e6
・bin\nicovideoE.dll　　　　統合版拡張Vhookライブラリ　従来＋ワイド(16x9用)
・bin\libSDL_gfx-13.dll　　 グラフィックライブラリ,ライセンスはLGPL
　　　　　　　　　　　　　　 nicovideoE.dllに必要
・saccubus1.22r3e6_src.zip
　　Saccubus.jarのjavaソースファイル、eclipseプロジェクトファイル
　　（nicovideoE.dllのソースファイルは変更なしのため省略）
・readme1.22r3e6.txt、readme.txt(1.22r)、readme+.txt(1.22r3)
・autodebug.bat　　　　　　　auto.batのログ記録用バッチファイル
・Saccubus.exe　　　　　　　ランチャー（1.22rの物）
・auto.bat、debug.bat　　　　　　　　 （1.22rの物）
・オプションファイル見本.xml　　　　　（1.22rの物）
　（1.22rは公式サイトからダウンロードページに行けます。）
　http://sourceforge.jp/projects/saccubus/downloads/30757/Saccubus-1.22r.zip/


変更履歴
1.22r3e6 (2011/8/11)
　セッション共有でIEの仕様変更に対応、対応ブラウザOpera追加

1.22r3e5 (2011/8/10)
　ブラウザのCookieからセッション情報を取得し共有する
　nicovideoE.dllをリリース（nicovideoとnicovideo16x9の統合版）

1.22r3e4a評価版 (2011/8/5)

1.22r3e4 (2011/8/3)
　ワイド画面(16;9)コメントサイズ半自動切り替え対応(仮)

1.22r3e3 (2011/8/1)
　DLファイル名のバグ修正、autodebug.bat収録

1.22r3e2 (2011/7/15)
　URLの後ろに ?hogehoge がある時、URLへの付加を行う

1.22r3e1a(2011/7/11)
　1.22r3e1のバグ修正、Saccubus.jarのみ

1.22r3e1 (2011/7/10) full set
　配布中止。nicovideo.dllに投稿者コメントを合成できない不具合があった

1.22r3e　(2011/7/5)
　改造版 Saccubus.jar リリース
