【ニコニコ】コメント付動画作成ツール さきゅばすスレ(前スレ)
<http://hibari.2ch.net/test/read.cgi/software/1235626069/>
の３４１氏の 1.22r3 を元に、NicoBrowser拡張1.4.4および
いんきゅばす1.7.0（作者：雪羽氏）の一部機能を借用して改造しました。
また、ニコニコランキングメーカーnicorankから機能を借用しました。

　・1.25 (2011/9/3)　コミュニティ動画での通常コメントを別レイヤーで
　　　　　　　　　　 半透明表示する機能追加

修正・改変点
　1.25
　・コミュニティ動画での通常コメントを、別レイヤーで半透明表示する
　　半透明化オン・オフ可能

　1.24以降
　・アスペクト比によるワイド選択の基準値を1.523(640x420)以上に変更
　　420より高さが低いものはワイド選択

　1.23r1以降
　・デバッグ時以外で変換できないバグ修正版1.23rのソース整理、
　　option SameQ aviを追加

　1.23以降
　・動画アスペクト比により4:3と16:9オプションを自動選択、オプション選択画面追加
　・再修正版optionファイル同梱
　・SDLライブラリ確定版同梱（SDL.dll, SDL_ttf.dll, libSDL_gfx-13.dll）
　・終了ステータスのログ表示修正

　1.22r3e9（リリースせず）
　1.22r3e8以降
　・新コメント表示対応、但し過去ログ・公式動画のコメントは非対応
　　（古いコメント表示となる）
　・auto2proc.bat 2プロセス自動実行バッチリリース
　・設定XMLがないときのデフォルトを変更

　1.22r3e7以降
　・セッション共有でChromium、その他のブラウザを追加

　1.22r3e6以降
　・セッション共有で８月のWindowsUpdateのIEのクッキー仕様変更に対応
　　対応ブラウザOpera追加、ログインチェック改善

　1.22r3e5以降
　・ブラウザからセッション情報を取得し共有、ブラウザがログアウトしない
　　IE7/8/9, Firefox5, Chrome13対応（nicorankから機能借用）
　・nicovideoE.dllをリリース（nicovideoとnicovideo16x9の統合版）
　・auto.batで引数が足りない時にstacktraceでなくエラーメッセージを出す

　1.22r3e4以降
　・ワイド画面(16;9)対応Vhookライブラリnicovideo16x9.dllを
　　従来のnicovideo.dllと半自動で切り替えられるように変更

　1.22r3e3以降
　・DLファル名にffmpegが認識できない文字があった時エラーとなるのを修正
　・内部記述修正色々、機能は変更なし

　1.22r3e2以降
　・ファイル選択ダイアログの結果のファイル名を絶対パス名から
　　相対パス名に変更
　・過去ログ指定時に文字列が解析できない場合と一般会員の場合は
　　エラー終了に変更。但し動画の保存は先に行えるようにする。
　・コメント付き動画の保存ファイル名を
　　　指定フォルダ\タイトル\オプションファイル名＋FFmpeg設定.拡張子
　　とする設定を追加（デバッグ用）
　・黒幕あり（-padtop,-padbottom）を新しいffmpeg(rev.23043以降)で
　　-vfilters pad=に変更したときに、vhookライブラリと両立出来るように修正
　・｢不適切な内容が含まれている｣動画をダウンロードする場合に
　　http://www.nicovideo.jp/watch/sm1234556789?watch_harmful=1
　　と指定すればダウンロード出来るように修正

　1.22r3e1a以降
　・NicoBrowser拡張1.4.4用のffmpegに対する不具合を修正
　・過去ログを結合中のデバッグ用メッセージの量を減らす
　・過去ログの結合方式を変更し不要な項目も残すように変更
　　（若干、結果ファイルサイズが増えた）

　1.22r3e以降
　・過去ログのダウンロードのURL修正（1.4.4と同等レベル）
　　（過去ログのダウンロードはプレミアム会員のみ）
　・公式動画のコメントをダウンロード可能（1.4.4と同等レベル）
　・投稿者コメントをダウンロード・付加可能（1.4.4と同等レベル）
　・自動で調整する取得コメント数を最新のニコニコ動画仕様に変更
　　1分間100コメ、10分以上は1000コメまで(1.22r3e8で更に修正)
　・動画タイトルの最後に付く空白を削除
　・コメントファイル名に[日時]を追加可能
　　複数のコメントファイルを動画に付加可能に。
　　（プレミアム会員で過去ログを使えば1000コメ以上付加可能）
　・投稿者コメントのスクリプト(ニワン語)を無視する
　　→投稿者のスクリプトが無駄に動画に付加されない。


おまけ
　1.22r3e4
　・選択した拡張Vhookの種類と動画サイズ・アスペクト比を表示
　　（自動判定時のみ）

　1.22r3e3以降
　・前回正常終了した時の動画idを記憶する（１つだけ）

　1.22r3e1a以降
　・ダウンロードした動画の設定FFmpegによるデコード結果の表示の際
　　フォルダ指定の場合は直前にダウンロードしていなくても捜して
　　デコードするように変更した。
　・ダウンロード・変換時の経過時間を表示
　・ダウンロード・変換時間と最終フレームの情報をデバッグログに出力

　1.22r3e以降
　・設定されたFFmpegのバージョンを表示
　・ダウンロードした動画の設定FFmpegによるデコード結果を表示
　　（動画サイズ、ビットレート、fps、動画codec、音声codecなど）


修正・改変点、おまけは、さきゅばす上で青文字で表示しています。


サポート解説など
　さきゅばすの使い方などに関しては、
　公式サイト　http://saccubus.sourceforge.jp/
　同梱のさきゅばす1.22rのreadme.txt、1.22r3のreadme+.txtを
　ご覧下さい。
　1.22r3e、1.23以降の不具合報告等はさきゅばすスレでお願いします。
　http://hibari.2ch.net/test/read.cgi/software/1310301611/


動作環境
　Windows XP/7　32bit（多分Vistaも動くはず）
　　　　　　　（64bitは環境が無い為テストしていません）。
　javaランタイム（JRE1.6 または JDK6）が必要です。
　　　　　　　　（JRE1.5 JDK5はテストしていません。）

注意
　・本Revの人柱用レベルは前Rev.と同じくらいです。
　・64bitWinは元々動作確認していませんが今回も非対応です。


●注意●
　・本Rev.は確定版SDLライブラリを同梱しています。（binフォルダ内）
　　1.22r3e8aBETAのSDLライブラリは使用しないで下さい。
　・本Rev.は再修正版optionファイルを同梱しています。
　　1.22r3 1.22r3e8aBETA 及び本スレ>>153のoptionファイルは■破棄・削除■して下さい。

インストール方法と拡張機能設定
　既にさきゅばすを使用中の方
　・Saccubus.jarと
　　bin\nicovideoE.dllを差し替えます。
　以下は1.23より前のRev.をお使いの方のみ必要です。
　・本Rev.のbinフォルダ内のファイルを使用中のbinフォルダに
　　コピーして下さい。
　　(もしファイルが上書きされる場合、先にバックアップして下さい)
　・自分で修正したoptionファイルをお持ちの方は
　　自分が使用するオプションファイルだけ別の場所に移動して下さい。
　　元のoptionフォルダを■削除■して下さい。
　　本Rev.のoptionフォルダをさきゅばすフォルダにコピーして下さい。
　　移動したファイルをoption内にコピーして戻して下さい。
　・動画アスペクト比によるオプション自動判定ができるようになりました。
　　「動画設定」「変換オプション設定」「FFmpegの設定１」と「FFmpegの設定２」に
　　自動判定の結果選択するオプションを設定します。
　・拡張Vhookライブラリ指定は、「動画設定」画面の2つある拡張Vhook
　　指定欄の両方に nicovideoE.dll を指定し、2個のチェックボックス
　　両方にチェックするとDL動画のアスペクト比を自動判定します。
　・ブラウザ情報共有設定で「上記以外のブラウザの…」にチェックする
　　場合は、Cookiesファイルの場所、複数候補の場合はその親フォルダを
　　指定して下さい。
　・nicovideoE.dllで変換エラーが発生する動画の報告がありました。
　　（ニコ生の録画とコメントをローカルで変換した場合）
　　が、その後の確認で状況が変わったため元に戻しました。
　　問題は対処済みですが万一エラー時はnicovideo.dllに変更して下さい。


　初めてさきゅばすを使う方
　・前スレ>>341
　　(http://www.ne.jp/asahi/mochiyama/my/file/Saccubus-1.22r3.zip)
　　をダウンロードし展開します。
　　binフォルダの FFmpeg.exe、nicovideo.dll が必要です。
　　*** 同梱しているbinフォルダのファイルだけでは動作しません ***
　・1.22r3のoptionフォルダを■削除■して下さい。
　・本Rev.を1.22r3を展開したフォルダにコピーします。
　　念の為に、元のSaccubus.jarはリネーム後保存しておいて下さい。
　　Saccubus.jarを差し替えてください。
　　binフォルダ内は■上書き■します。
　・ブラウザ情報共有設定で「上記以外のブラウザの…」にチェックする
　　場合は、Cookiesファイルの場所、複数候補の場合はその親フォルダを
　　指定して下さい。
　・投稿者コメントを付加して動画にしたい場合は
　　「保存設定」「動画・コメント」「投稿者コメント保存設定」と
　　「保存設定」「コメント付き動画」「投稿者コメントを付加する」に
　　チェックします。スクリプトは再現されません。


起動
　　Saccubus.exe または Saccubus.jarをダブルクリックします。
　　ブラウザ共有を選択するか、または
　　メールアドレス、パスワードを入力します。
　　動画idを入力します。URLの後ろに?hogehogeがついてもOKです。
　　（不適切な内容が含まれている場合は、?watch_harmful=1 をつけます）
　　過去ログをダウンロードするには（プレミアム会員が必要条件）日付を
　　2009/7/7 7:7:7 や 2009/7/7 7:7 や 2009/7/7 のように入力します。
　　右上の変換ボタンをクリックするとダウンロードと変換が開始します。

●コミュニティ動画の通常コメント表示機能について
　・コミュニティ動画のID（URL)を指定して保存すると、通常コメントを
　　ファイル名の最後に{Optional}.xmlが付加されたコメントファイルが
　　コメントフォルダまたは指定フォルダに保存されます。
　・保存と同時に変換を行うか、上記ファイルがある状態で変換を行うと
　　従来のコミュニティコメントに加え通常コメントを合成して変換します。
　・デフォルトではニコニコ動画と同様、通常コメントを半透明にして合成しますが
　　「保存設定」「コメント付き動画」タブ「オプショナルスレッド設定」で
　　<通常コメントを半透明にする>チェックを外すと不透明になります。

●新コメント表示対応について
　・制限事項
　　過去ログ・公式動画のコメントは非対応。古いコメント表示となります。

　■本機能は「いんきゅばす1.7.0」（旧NicoBrowser対応さきゅばす拡張）を
　　参考にしました。感謝。以下に説明とリンクがあります。
　　　http://feather.cocolog-nifty.com/weblog/2011/08/170-ff9c.html
　　coroid project　「いんきゅばす」を含む　ライセンス AGPLv3
　　　http://sourceforge.jp/projects/coroid/

●２プロセス自動実行について
　・ダウンロードと変換を合わせて、２プロセス自動実行が出来ます。
　　ダウンロードが２重になり、ニコ動サーバーの負荷が上がりますが
　　変換と交互にすれば問題はないと思います。
　　ダウンロードのみの２プロセス実行は非推奨です。
　　変換のみの２プロセス実行は構いません。
　・バッチファイルによるマルチプロセスなので、
　　ffmpegの違いやlibのマルチスレッド対応には関係ありません。
　　ただし3コア以上の場合は１００％使用率にはならないことがあります。
　　実行能力の問題でマルチコアCPU推奨です。
　・実行方法
　　AUTO2PROC.BAT　　　　２プロセス自動実行本体…ダブルクリックで起動
　　AUTO2PROCDEBUG.BAT　 ２プロセス自動実行ログ記録…ダブルクリックで起動
　■バッチファイルを変更すればソフト的には２プロセス以上も可能なはずですが
　　２プロセス以上のダウンロードを行う時は、ニコ動サーバーの負荷を配慮の上、
　　自己責任でお願いします。
　　※アカウントがブロックされる可能性があります。
　　　その場合はブラウザでログインし対処する必要があります。

●ブラウザのセッション共有機能について
　・セッションを共有したいブラウザの所にチェックします。
　・ブラウザでログインしていれば、さきゅばす側でメールアドレス、
　　パスワードを入力しなくてもニコニコ動画からDL出来ます。
　・さきゅばすが後からログインしてもブラウザはログアウトされません。
　・ブラウザを終了してもPCを電源OFFしてもログインされたままです。
　　（セッションの期限切れまで）
　・ブラウザがログアウトした場合は、さきゅばすもログイン出来ません。
　　その場合は、ブラウザでもう一度ログインするか、
　　さきゅばす側で単体でログインして下さい。
　　但し、さきゅばす単体でログインした場合は残念ながら、ブラウザが
　　ログアウトされます。
　　（ブラウザがさきゅばすのセッション情報を利用できないため）
　◆ブラウザ情報共有設定で「上記以外のブラウザの…」にチェックする
　　場合は、Cookiesファイルの場所、複数候補の場合はその親フォルダを
　　指定して下さい。
　　（参考）大抵の場合は　%USERPROFILE%フォルダ
　　　（XP 32の場合　　　　　C:\Doccuments and Settings\ユーザー名\
　　　　Win7,Vista 32の場合　C:\Users\ユーザー名\ ）の下に
　　　　メーカー名\製品名\〇〇\Cookies〇〇
　　　というファイルがあります。

　■本機能はニコニコランキングメーカーnicorankから頂きました。感謝。
　　ニコニコランキングメーカー配布サイト↓
　　http://www.daily-vocaran.info/nicorank/
　　ソースファイル↓
　　http://sourceforge.jp/projects/nicorank/downloads/40282/nicorank186_src.zip/
　　（最新版ソースは SVN　http://svn.sourceforge.jp/svnroot/nicorank/）


●拡張Vhook統合版 (nicovideoE.dll)について
　・nicovideo.dllのソースから、投稿者コメント付加機能と、
　　nicovideo16x9のワイド対応修正を統合しました。(多少の差有)
　・拡張Vhook統合版の指定方法は下の拡張Vhookワイドと同じですが
　　２つの指定場所の両方に同じnicovideoE.dllを指定します。
　※1.22r3e4a以前のさきゅばす本体との使用も可能ですが、
　　自動判定は出来ません。従来モード固定となります。

●拡張Vhookワイド（nicovideo16x9.dll）について
　（1.22r3e4以外には入っていません。）
　・従来のnicovideo.dllより、16:9動画での字の大きさはニコニコ公式に
　　近いですが完全な再現は未達成です。(nicovideoE.dllの修正を検討中)
　・拡張Vhookの指定方法は次の通りです。
　　２個選択時→DL動画を検査してアスペクト比を判定しVhookを選択
　　１個選択時→指定されたVhookを使用して変換、無検査
　　０個選択時→エラー
　■　コメント付き動画(変換後)のアスペクト比を変更したり　■
　■　判定したりはしないので注意してください。　　　　　　■

●過去ログを複数ファイルに保存する
　・「保存設定」「動画・コメント」画面の
　　<保存するフォルダを指定し、ファイル名は自動で決定する>と
　　<コメントファイル名に時刻を付加する>チェックボックスを
　　チェックします。<取得コメント数>は1000に設定します。
　　1000以上にしても１回にダウンロード出来るのは1000までです。
　　最初は「保存設定」「コメント付き動画」画面の
　　<動画を変換する>にチェックをしません。

　・まず過去ログを日付を変えて複数回ダウンロードします。
　　<動画をダウンロードする>のは1回だけで十分です。

　・過去ログが集まったら、<動画を変換する>をチェックし、
　　変換ボタンをクリックすると、同一IDの全コメントを結合して
　　コメント付き動画に変換します。

　・同時表示コメント数を増やすには「変換設定」画面の
　　<表示コメント数>を、既定値の４０より大きくします。

　・動画をダウンロードした直後に「動画設定」画面の一番下の
　　<DL動画>ボタンをクリックして動画をチェックしておくと
　　FFmpegの設定ミスが減らせるかも？

●動作が変なときは
　・debug.batをダブルクリックして起動します。
　　本体が起動するので後は同じです。終了後
　　ログがフォルダ直下の log.txt に出力されるので
　　参考にして下さい。
　・作業ファイルは直下のtempフォルダの下に作成しますが
　　実行が終了すると削除します。

●auto.batで動作が変な時、記録を取りたい時は
　・auto.batの記述を確かめます。
　・autodebug.batをダブルクリックして起動します。
　　auto.batが実行されるので終了するまで待ちます。
　　途中でエラーが起きても、最後の動画まで実行してから終了します。
　　autolog.txtにログが記録されます。


■機能確認
　・ブラウザのセッション共有機能確認は
　　Win7 Home 32bit + IE9, Firefox5.0, Chrome13, SRware 及び
　　XP SP3 Home 32bit + IE8, Firefox5.0, Chrome13, SRware で行いました。
　・動画変換確認は、1.22r3（SVN-21400 前スレ341）で行いました。
　　Win7 32bit Core2Duo, WinXP 32bit CeleronD
　・但し再生確認はPC上だけで、携帯その他では未確認
　・前スレ>>670 は変換エラーする動画(Decoder not found)がありました。
　・前スレ>>481(SVN-23386)は livx264でのマルチスレッドオプション
　　（-threads）が機能しないかもしれません。
　・いんきゅばす（旧NicoBrowser拡張さきゅばす1.4.4以降）用に配布している
　　ffmpegも動くかもしれません。
　　（nicovideo.dll、optionファイルは非互換の可能性があります。）


収録物
・まず最初に.txt
・LICENSE.txt　　　　　　　 GPLライセンス
・gpl.ja.txt 　　　　　　　 GPLライセンスの非公式日本語訳
・LGPL_LICENSE　　　　　　　LGPLライセンス
・agpl-3.0.txt　　　　　　　AGPLv3ライセンス
・Saccubus.jar　　　　　　　本体　1.25
・Bin.jar　　　　　　　　　 ランタイムライブラリ
・bin フォルダ配下
　　nicovideoE.dll(2011.9.3版)統合版拡張Vhookライブラリ　従来＋ワイド(16x9用)
　　libSDL_gfx-13.dll、SDL.dll、SDL_ttf.dll
　　　グラフィックライブラリ、ライセンスはLGPL、nicovideoE.dllに必要
・option フォルダ配下　　　 変換オプションファイル
・saccubus_src.zip
　　Saccubus.jar　のjavaソースファイル、eclipseプロジェクトファイル
　　nicovideoE.dll(2011.9.3版)　のソースファイル、eclipseプロジェクトファイル
　　Bin.jar　のjavaソースファイル、eclipseプロジェクトファイル
・readmeNew.txt、readme.txt(1.22r)、readme+.txt(1.22r3)
・debug.bat　　　　　　　　 ログ記録用バッチファイル(1.22rの修正版)
・autodebug.bat　　　　　　 auto.batのログ記録用バッチファイル
・AUTO2PROC.BAT　　　　　　 ２プロセス自動実行本体
・AUTO2PROCDEBUG.BAT　　　  ２プロセス自動実行時のログ記録用
・Saccubus.exe　　　　　　　ランチャー（1.22rの物）
・auto.bat 　　　　　　　　 　　　　　　（1.22rの物）
・オプションファイル見本.xml　　　　　　（1.22rの物）

関連リンク
・ソースコード
　http://sourceforge.jp/projects/saccubus/svn/view/trunk
　SVN：svn checkout http://svn.sourceforge.jp/svnroot/saccubus/trunk

・ダウンロード
　1.24　　　http://www1.axfc.net/uploader/File/so/68541.zip
　1.23r1　　http://www1.axfc.net/uploader/File/so/68295.zip
　1.23　　　http://www1.axfc.net/uploader/File/so/68280.zip
　1.22r3e8　http://www1.axfc.net/uploader/File/so/67805.zip
　1.22r3e7　http://www1.axfc.net/uploader/File/so/67571.zip
　1.22r3e6　http://www1.axfc.net/uploader/File/so/67535.zip
　1.22r3e5　http://www1.axfc.net/uploader/File/so/67499.zip
　1.22r3e4　http://www1.axfc.net/uploader/File/so/67192.zip
　1.22r3e3　http://www1.axfc.net/uploader/File/so/67064.zip
　1.22r3e2　http://www1.axfc.net/uploader/File/so/66071.zip
　1.22r3e1a http://www1.axfc.net/uploader/File/so/65862.zip
　1.22r3　　http://www.ne.jp/asahi/mochiyama/my/file/Saccubus-1.22r3.zip
　1.22r　http://sourceforge.jp/projects/saccubus/downloads/30757/Saccubus-1.22r.zip/

・サイト
　さきゅばす公式
　　http://saccubus.sourceforge.jp/
　coroid project　「いんきゅばす」を含む
　　http://sourceforge.jp/projects/coroid/
　ニコニコランキングメーカー(nicorank)配布サイト↓
　　http://www.daily-vocaran.info/nicorank/

変更履歴
1.25（2011/9/3）
　コミュニティ動画での通常コメントを、別レイヤーで半透明表示する
　半透明化オン・オフ可能

1.24 (2011/9/2)
　アスペクト比によるワイド選択の基準値を1.523(640x420)以上に変更

1.23r1 (2011/8/28)
　バグ修正版1.23rのソース整理、option SameQ aviを追加

1.23r (2011/8/28)
　バグ修正版、Saccubus.jarのみ

1.23 (2011/8/27)
　動画アスペクト比により4:3と16:9オプションを自動選択、オプション選択画面追加
　再修正版optionファイル同梱
　SDLライブラリ確定版同梱（SDL.dll, SDL_ttf.dll, libSDL_gfx-13.dll）
　終了ステータスのログ表示修正

1.22r3e9 (リリースせず）
1.22r3e8 (2011/8/18)
　新コメント表示対応、但し過去ログ・公式動画のコメントは非対応
　２プロセス自動実行バッチリリース、設定XMLがない時のデフォルト変更

1.22r3e7 (2011/8/12)
　セッション共有でChromium、その他のブラウザを追加

1.22r3e6 (2011/8/11)
　セッション共有でIEの仕様変更に対応、対応ブラウザOpera追加

1.22r3e5 (2011/8/10)
　ブラウザのCookieからセッション情報を取得し共有する
　nicovideoE.dllをリリース（nicovideoとnicovideo16x9の統合版）

1.22r3e4a評価版 (2011/8/5)

1.22r3e4 (2011/8/3)
　ワイド画面(16;9)コメントサイズ半自動切り替え対応(仮)

1.22r3e3 (2011/8/1)
　DLファイル名のバグ修正、autodebug.bat収録

1.22r3e2 (2011/7/15)
　URLの後ろに ?hogehoge がある時、URLへの付加を行う

1.22r3e1a(2011/7/11)
　1.22r3e1のバグ修正、Saccubus.jarのみ

1.22r3e1 (2011/7/10) full set
　配布中止。nicovideo.dllに投稿者コメントを合成できない不具合があった

1.22r3e　(2011/7/5)
　改造版 Saccubus.jar リリース
